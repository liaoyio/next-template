# Next App Router

```


- 当一个文件夹下因为没有编写 page.js 文件时，所以没有对应的路由。这个文件可以被用于存放组件、样式表、图片或者其他文件。

## 定义布局Layouts

- 同一文件夹下如果有 layout.js 和 page.js，page 会作为 children 参数传入 layout。换句话说，layout 会包裹同层级的 page。 

## 根布局（Root Layout）

布局支持嵌套，最顶层的布局我们称之为根布局（Root Layout），也就是 app/layout.js。它会应用于所有的路由。除此之外，这个布局还有点特殊。

```tsx
// app/layout.tsx
import './globals.css'
import { Inter } from 'next/font/google'

const inter = Inter({ subsets: ['latin'] })

export const metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
}

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body className={inter.className}>{children}</body>
    </html>
  )
}
```
- app 目录必须包含根布局，也就是 app/layout.js 这个文件是必需的。
- 根布局必须包含 html 和 body标签，其他布局不能包含这些标签。但如果你要更改这些标签，不推荐直接修改，Next.js 提供内置工具帮助你管理诸如 `<title />` 这样的 HTML 元素。
- 默认根布局是服务端组件，且不能设置为客户端组件。


##  定义模板（Templates）

```tsx
// app/template.tsx
export default function Template({ children }: { children: React.ReactNode }) {
  return <div>{children}</div>
}
```

- `template` 类似于 `layout` ，它也会传入每个子 `layout` 或者 `page`。但不会像`layout`那样维持状态。
- `template` 在路由切换时会为每一个 children 创建一个实例。这就意味着当用户在共享一个模板的路由间跳转的时候，将会重新挂载组件实例，重新创建 DOM 元素，不保留状态。


从上面创建 `template` 的代码中，你会发现这用和创建 `layout` 一模一样。它们最大的区别就是状态的保持。如果同一目录下既有 `template.tsx` 也有 `layout.tsx`，最后的输出效果如下:

```tsx
<Layout>
  {/* 模板需要给一个唯一的 key */}
  <Template key={routeParam}>{children}</Template>
</Layout>
```

也就是说 `layout` 会包裹 `template`，`template` 又会包裹 `page`。


**某些情况下，模板会比布局更适合：**

- 依赖于 `useEffect` 和 `useState` 的功能，比如记录页面访问数（维持状态就不会在路由切换时记录访问数了）、用户反馈表单（每次重新填写）等

- 更改框架的默认行为，举个例子，`layout` 中的 Suspense 只会在布局加载的时候展示一次 fallback UI，当切换页面的时候不会展示。但是使用模板，`fallback` 会在每次路由切换的时候展示。
